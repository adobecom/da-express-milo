/**
 * Floating Search Block Styles
 * 
 * Mobile-first approach:
 *   Base: Mobile (< 768px)
 *   768px+: Tablet
 *   1024px+: Desktop
 * 
 * Note: Suggestions dropdown styles loaded dynamically via suggestions-dropdown.css
 */

@import url('./styles/vars.css');

/* ==============================================
   Sentinel (IntersectionObserver trigger point)
   ============================================== */

.search-bar-sentinel {
  position: absolute;
  inset-block-start: 0;
  inset-inline-start: 0;
  block-size: 1px;
  inline-size: 100%;
  pointer-events: none;
}

/* ==============================================
   Outer Wrapper (maintains position in flow)
   ============================================== */

.search-bar-outer {
  display: flex;
  flex-direction: column;
  align-items: center;
  inline-size: 100%;
  max-inline-size: 100%;
  padding-inline: var(--fs-spacing-md, var(--spectrum-spacing-300, 16px));
  position: relative;
}

/* ==============================================
   Search Container (wraps input + dropdown)
   ============================================== */

.search-bar-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 0;
  gap: var(--fs-spacing-sm, var(--spectrum-spacing-200, 10px));
  inline-size: 100%;
  max-inline-size: 100%;
  position: relative;
  z-index: 5;
}

/* ==============================================
   Search Wrapper
   ============================================== */

.search-bar-wrapper {
  inline-size: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.search-bar-form {
  inline-size: 100%;
}

.search-input-wrapper {
  position: relative;
  inline-size: 100%;
  display: flex;
  align-items: center;
}

/* ==============================================
   Search Input (Mobile Base)
   ============================================== */

.search-bar-input {
  inline-size: 100%;
  block-size: var(--fs-search-height, var(--spectrum-component-height-100, 40px));
  border-radius: var(--fs-search-radius, var(--spectrum-corner-radius-200, 50px));
  border: 1px solid var(--fs-color-border, var(--spectrum-gray-300, #d5d5d5));
  padding-inline: var(--fs-spacing-xl, var(--spectrum-spacing-500, 40px));
  font-family: 'Adobe Clean', adobe-clean, sans-serif;
  font-size: var(--spectrum-font-size-100, 14px);
  font-weight: 400;
  line-height: 1.3;
  color: var(--fs-color-text-primary, var(--spectrum-gray-900, #1d1d1d));
  background: var(--fs-color-bg-primary, var(--spectrum-gray-50, #fff));
  outline: none;
  transition:
    border-color var(--fs-transition-fast, 130ms) var(--fs-easing-default, ease),
    box-shadow var(--fs-transition-fast, 130ms) var(--fs-easing-default, ease);
}

.search-bar-input:hover {
  border-color: var(--fs-color-border-hover, var(--spectrum-gray-400, #b8b8b8));
}

.search-bar-input:focus,
.search-bar-input:focus-visible {
  border-color: var(--spectrum-gray-800, #323232);
  box-shadow: 0 0 0 1px var(--spectrum-gray-800, #323232);
  outline: none;
}

.search-bar-input::placeholder {
  color: var(--fs-color-text-tertiary, var(--spectrum-gray-600, #6d6d6d));
}

/* Remove native search input clear button */
.search-bar-input::-webkit-search-cancel-button,
.search-bar-input::-webkit-search-decoration {
  -webkit-appearance: none;
  appearance: none;
}

/* ==============================================
   Search Icon (Left)
   ============================================== */

.search-icon {
  position: absolute;
  inset-inline-start: var(--fs-spacing-md, var(--spectrum-spacing-300, 16px));
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  color: var(--fs-color-text-secondary, var(--spectrum-gray-700, #505050));
}

.search-icon svg {
  inline-size: var(--spectrum-icon-size-200, 20px);
  block-size: var(--spectrum-icon-size-200, 20px);
}

/* ==============================================
   Clear Button (Right)
   ============================================== */

.search-clear-btn {
  position: absolute;
  inset-inline-end: var(--fs-spacing-sm, var(--spectrum-spacing-200, 12px));
  display: flex;
  align-items: center;
  justify-content: center;
  inline-size: var(--spectrum-component-height-75, 32px);
  block-size: var(--spectrum-component-height-75, 32px);
  background: transparent;
  border: none;
  padding: 0;
  cursor: pointer;
  color: var(--fs-color-text-secondary, var(--spectrum-gray-700, #505050));
  border-radius: var(--spectrum-corner-radius-100, 4px);
  transition:
    background-color var(--fs-transition-fast, 130ms) var(--fs-easing-default, ease),
    color var(--fs-transition-fast, 130ms) var(--fs-easing-default, ease);
}

.search-clear-btn:hover {
  background-color: var(--fs-color-bg-active, var(--spectrum-gray-200, #e6e6e6));
  color: var(--fs-color-text-primary, var(--spectrum-gray-900, #1d1d1d));
}

.search-clear-btn:focus-visible {
  outline: var(--fs-focus-width, 2px) solid var(--fs-focus-color, #0265dc);
  outline-offset: var(--fs-focus-offset, 2px);
}

.search-clear-btn svg {
  inline-size: var(--spectrum-icon-size-200, 20px);
  block-size: var(--spectrum-icon-size-200, 20px);
}

/* Hidden state */
.search-clear-btn.hidden {
  display: none;
}

/* Fetching state */
.search-bar-container.is-fetching .search-bar-input {
  opacity: 0.7;
}

/* ==============================================
   Return Animation
   ============================================== */

.search-bar-container.is-returning {
  animation: searchBarFadeIn var(--fs-transition-normal, 200ms) ease-out;
}

@keyframes searchBarFadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

/* ==============================================
   Sticky Wrapper (Mobile Base)
   ============================================== */

.search-bar-sticky-wrapper.is-sticky-clone {
  position: fixed;
  inset-block-end: 5%;
  inset-inline-start: var(--fs-spacing-md, var(--spectrum-spacing-300, 16px));
  inset-inline-end: var(--fs-spacing-md, var(--spectrum-spacing-300, 16px));
  inline-size: auto;
  z-index: var(--fs-z-index-sticky, 100);
  box-shadow: var(--spectrum-drop-shadow-emphasis, 0 8px 16px rgba(0, 0, 0, 0.15));
  background: var(--fs-color-bg-primary, var(--spectrum-gray-50, #fff));
  border-radius: var(--fs-search-radius, 50px);
  padding: var(--fs-spacing-xs, var(--spectrum-spacing-100, 8px));
  opacity: 0;
  pointer-events: none;
  visibility: hidden;
}

/* Visible state */
.search-bar-sticky-wrapper.is-sticky-clone.is-visible {
  opacity: 1;
  pointer-events: auto;
  visibility: visible;
  animation: searchBarSlideUpMobile var(--fs-transition-normal, 200ms) ease-out;
}

/* Leaving state */
.search-bar-sticky-wrapper.is-sticky-clone.is-leaving {
  animation: searchBarSlideDownMobile var(--fs-transition-normal, 200ms) ease-in forwards;
}

@keyframes searchBarSlideUpMobile {
  from {
    opacity: 0;
    transform: translateY(20px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes searchBarSlideDownMobile {
  from {
    opacity: 1;
    transform: translateY(0);
  }

  to {
    opacity: 0;
    transform: translateY(20px);
  }
}

/* ==============================================
   Tablet Breakpoint (768px+)
   ============================================== */

@media (min-width: 768px) {
  .search-bar-outer {
    inline-size: 100%;
    max-inline-size: 600px;
    padding-inline: 0;
  }

  .search-bar-input {
    block-size: var(--fs-search-height, var(--spectrum-component-height-200, 48px));
    padding-inline: var(--fs-spacing-xxl, var(--spectrum-spacing-600, 48px));
    font-size: var(--spectrum-font-size-200, 16px);
  }

  .search-bar-sticky-wrapper.is-sticky-clone {
    inset-inline-start: 50%;
    inset-inline-end: auto;
    transform: translateX(-50%);
    inline-size: var(--fs-search-max-width, 700px);
    max-inline-size: calc(100% - var(--fs-spacing-lg, 24px) * 2);
  }

  .search-bar-sticky-wrapper.is-sticky-clone.is-visible {
    animation: searchBarSlideUp var(--fs-transition-normal, 200ms) ease-out;
  }

  .search-bar-sticky-wrapper.is-sticky-clone.is-leaving {
    animation: searchBarSlideDown var(--fs-transition-normal, 200ms) ease-in forwards;
  }

  @keyframes searchBarSlideUp {
    from {
      opacity: 0;
      transform: translateX(-50%) translateY(20px);
    }

    to {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
  }

  @keyframes searchBarSlideDown {
    from {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    to {
      opacity: 0;
      transform: translateX(-50%) translateY(20px);
    }
  }
}

/* ==============================================
   Desktop Breakpoint (1024px+)
   ============================================== */

@media (min-width: 1024px) {
  .search-bar-outer {
    inline-size: var(--fs-search-max-width, 700px);
  }
}
